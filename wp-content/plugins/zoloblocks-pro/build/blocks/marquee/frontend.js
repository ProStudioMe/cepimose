document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".wp-block-zolo-marquee");gsap.registerPlugin(ScrollTrigger),e.length>0&&e.forEach((e=>{const t=JSON.parse(e.getAttribute("data-settings"));let r=gsap.utils.toArray(e.querySelectorAll(".wp-block-zolo-marquee-child"));const a={reversedDirection:"right"===t?.scrollDirection,marqueeSpeed:void 0!==t?.scrollSpeed?t?.scrollSpeed/10:1,isClickable:t?.clickToCenter||!1,isPauseOnHover:t?.pauseOnHover||!1,isDraggable:t?.draggable||!1,spacing:t?.spacing||0,isLoop:!1,initialPause:t?.initialPause||!1,marqueeType:t?.marqueeType||""};let o;r=(t=>{let r=t.reduce(((e,t)=>e+t.offsetWidth),0);if(0==r)return t;let a=window.innerWidth;for(;r<a;)t.forEach((t=>{const r=t.cloneNode(!0);e.firstChild.appendChild(r)})),r=(t=gsap.utils.toArray(e.querySelectorAll(".wp-block-zolo-marquee-child"))).reduce(((e,t)=>e+t.offsetWidth),0);return t})(r);const s=function(e,t,r=!1){e=gsap.utils.toArray(e);let a,o,s,n=(t=t||{}).onChange,i=gsap.timeline({repeat:t.repeat,paused:t.paused,defaults:{ease:"none"},onReverseComplete:()=>i.totalTime(i.rawTime()+100*i.duration())}),l=e.length,d=e[0].offsetLeft,p=[],g=[],c=[],u=[],f=0,m=t.center,h=100*(t.speed||1),v=!1===t.snap?e=>e:gsap.utils.snap(t.snap||1),b=0,y=!0===m?e[0].parentNode:gsap.utils.toArray(m)[0]||e[0].parentNode,w=()=>{let r,o=y.getBoundingClientRect();e.forEach(((e,t)=>{g[t]=parseFloat(gsap.getProperty(e,"width","px")),u[t]=v(parseFloat(gsap.getProperty(e,"x","px"))/g[t]*100+gsap.getProperty(e,"xPercent")),r=e.getBoundingClientRect(),c[t]=r.left-(t?o.right:o.left),o=r})),gsap.set(e,{xPercent:e=>u[e]}),a=e[l-1].offsetLeft+u[l-1]/100*g[l-1]-d+c[0]+e[l-1].offsetWidth*gsap.getProperty(e[l-1],"scaleX")+(parseFloat(t.paddingRight)||0)},P=()=>{b=m?i.duration()*(y.offsetWidth/2)/a:0,m&&p.forEach(((e,t)=>{p[t]=o(i.labels["label"+t]+i.duration()*g[t]/2/a-b)}))},x=(e,t,r)=>{let a,o=e.length,s=1e10,n=0;for(;o--;)a=Math.abs(e[o]-t),a>r/2&&(a=r-a),a<s&&(s=a,n=o);return n},T=()=>{let t,r,s,n,f;for(i.clear(),t=0;t<l;t++)r=e[t],s=u[t]/100*g[t],n=r.offsetLeft+s-d+c[0],f=n+g[t]*gsap.getProperty(r,"scaleX"),i.to(r,{xPercent:v((s-f)/g[t]*100),duration:f/h},0).fromTo(r,{xPercent:v((s-f+a)/g[t]*100)},{xPercent:u[t],duration:(s-f+a-s)/h,immediateRender:!1},f/h).add("label"+t,n/h),p[t]=n/h;o=gsap.utils.wrap(0,i.duration())},q=e=>{let t=i.progress();i.progress(0,!0),w(),e&&T(),P(),e&&i.draggable?i.time(p[f],!0):i.progress(t,!0)};function C(e,t){t=t||{},r&&(e=l-e),Math.abs(e-f)>l/2&&(e+=e>f?-l:l);let a=gsap.utils.wrap(0,l,e),n=p[a];return n>i.time()!=e>f&&(n+=i.duration()*(e>f?1:-1)),(n<0||n>i.duration())&&(t.modifiers={time:o}),f=a,t.overwrite=!0,gsap.killTweensOf(s),i.tweenTo(n,t)}if(gsap.set(e,{x:0}),w(),T(),P(),window.addEventListener("resize",(()=>q(!0))),i.next=e=>C(f+1,e),i.previous=e=>C(f-1,e),i.current=()=>f,i.toIndex=(e,t)=>C(e,t),i.closestIndex=e=>{let t=x(p,i.time(),i.duration());return e&&(f=t),t},i.times=p,i.progress(1,!0).progress(0,!0),t.reversed&&(i.vars.onReverseComplete(),i.reverse()),t.draggable&&"function"==typeof Draggable){s=document.createElement("div");let t,r,n,l=gsap.utils.wrap(0,1),d=()=>i.progress(l(r+(n.startX-n.x)*t)),g=()=>i.closestIndex(!0);"undefined"==typeof InertiaPlugin&&console.warn("InertiaPlugin required for momentum-based scrolling and snapping. https://greensock.com/club"),n=Draggable.create(s,{trigger:e[0].parentNode,type:"x",onPressInit(){gsap.killTweensOf(i),r=i.progress(),q(),t=1/a,gsap.set(s,{x:r/-t})},onDrag:d,onThrowUpdate:d,inertia:!0,snap:e=>{let r=-e*t*i.duration(),a=o(r),s=p[x(p,a,i.duration())]-a;return Math.abs(s)>i.duration()/2&&(s+=s<0?i.duration():-i.duration()),(r+s)/i.duration()/-t},onRelease:g,onThrowComplete:g})[0],i.draggable=n}return i.closestIndex(!0),n&&n(e[f],f),i}(r,{paused:!1,draggable:a.isDraggable,repeat:-1,speed:a.marqueeSpeed,paddingRight:0,reversed:a.reversedDirection,center:!0,onChange:e=>{o&&o.classList.remove("active"),e.classList.add("active"),o=e}});if("scroll"===a.marqueeType){const t=gsap.quickTo(s,"timeScale",{duration:.05,ease:"power1.inOut"});ScrollTrigger.create({trigger:e,start:"top bottom",end:"bottom top",onUpdate:e=>{const r=Math.abs(e.getVelocity()),o=a.reversedDirection?-e.direction:e.direction;let n=a.initialPause?0*o:1*o;r>.01?s.play():0===r&&a.initialPause&&s.pause(),t(r/250*o),gsap.delayedCall(.5,(()=>t(n)))}})}"scroll"!==a.marqueeType&&(a.isPauseOnHover&&function(e,t){let r=a.reversedDirection;t.forEach((t=>{t.addEventListener("mouseenter",(()=>{gsap.to(e,{timeScale:0,duration:1})})),t.addEventListener("mouseleave",(()=>{gsap.to(e,{timeScale:r?-1:1,duration:1})}))}))}(s,r),a.isClickable&&function(e,t){t.forEach(((t,r)=>{t.addEventListener("mouseleave",(()=>{e.reversed()?(e.play(),e.reverse()):(e.play(),e.reversed())})),t.addEventListener("click",(()=>{e.toIndex(r,{duration:.8,ease:"power1.inOut"})}))}))}(s,r))}))}));